@model List<Trendify.Models.Product>
@{
    ViewData["Title"] = "Home - Trendify";
    var categories = ViewBag.Categories as List<Trendify.Models.Category>;
}

<!-- Hero Section -->
<section class="hero-section bg-dark text-white py-5 mb-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h1 class="display-4 fw-bold mb-4">Summer Collection 2025</h1>
                <p class="lead mb-4">Discover the latest trends in fashion with our exclusive summer collection. Quality meets style in every piece.</p>
                <a href="@Url.Action("Index", "Products")" class="btn btn-primary btn-lg px-5">Shop Now</a>
            </div>
            <div class="col-lg-6 text-center">
                <div class="hero-image-placeholder bg-light rounded" style="height: 400px; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-tshirt fa-5x text-muted"></i>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Categories Section -->
<section class="categories-section mb-5">
    <div class="container">
        <h2 class="text-center mb-5 fw-bold">Shop By Category</h2>
        <div class="row g-4">
            @if (categories != null && categories.Any())
            {
                @foreach (var category in categories)
                {
                    <div class="col-md-4 col-lg-2 col-sm-6">
                        <div class="category-card card border-0 shadow-sm h-100 text-center">
                            <div class="category-icon bg-light rounded-circle mx-auto mt-3" style="width: 80px; height: 80px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-tshirt fa-2x text-primary"></i>
                            </div>
                            <div class="card-body">
                                <h5 class="card-title">@category.Name</h5>
                                <p class="card-text text-muted small">@category.Products.Count products</p>
                                <a href="@Url.Action("Index", "Products", new { categoryId = category.Id })" class="btn btn-outline-primary btn-sm">Explore</a>
                            </div>
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="col-12 text-center">
                    <p class="text-muted">No categories available.</p>
                </div>
            }
        </div>
    </div>
</section>

<!-- Featured Products -->
<section class="featured-products mb-5">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="fw-bold">Featured Products</h2>
            <a href="@Url.Action("Index", "Products")" class="btn btn-outline-primary">View All</a>
        </div>

        <div class="row g-4">
            @if (Model != null && Model.Any())
            {
                @foreach (var product in Model)
                {
                    <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="card product-card h-100 border-0 shadow-sm">
                            <!-- Fixed Image Container -->
                            <div class="product-image-container">
                                <img src="@product.ImageUrl" class="product-list-image" alt="@product.Name"
                                     onerror="this.onerror=null; this.src='/images/products/default.jpg'">
                                @if (product.IsFeatured)
                                {
                                    <span class="featured-badge">Featured</span>
                                }
                                @if (product.StockQuantity <= 0)
                                {
                                    <div class="out-of-stock-overlay">
                                        <span>Out of Stock</span>
                                    </div>
                                }
                            </div>

                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title product-name">@product.Name</h5>
                                <p class="card-text text-muted small product-brand">@product.Brand</p>
                                <div class="mt-auto">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="h5 text-primary mb-0">$@product.Price.ToString("0.00")</span>
                                        @if (product.StockQuantity > 0)
                                        {
                                            <span class="badge bg-success">In Stock</span>
                                        }
                                        else
                                        {
                                            <span class="badge bg-danger">Out of Stock</span>
                                        }
                                    </div>
                                </div>
                            </div>

                            <div class="card-footer bg-transparent border-0 pt-0">
                                <div class="d-grid gap-2">
                                    <a href="@Url.Action("Details", "Products", new { id = product.Id })" class="btn btn-outline-primary btn-sm">View Details</a>
                                    @if (product.StockQuantity > 0 && User.Identity.IsAuthenticated)
                                    {
                                        <form asp-controller="Cart" asp-action="AddToCart" method="post">
                                            <input type="hidden" name="productId" value="@product.Id" />
                                            <input type="hidden" name="quantity" value="1" />
                                            <button type="submit" class="btn btn-primary btn-sm w-100">
                                                <i class="fas fa-shopping-cart me-2"></i>Add to Cart
                                            </button>
                                        </form>
                                    }
                                    else if (!User.Identity.IsAuthenticated)
                                    {
                                        <a href="/Identity/Account/Login" class="btn btn-primary btn-sm w-100">
                                            <i class="fas fa-shopping-cart me-2"></i>Login to Buy
                                        </a>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="col-12 text-center">
                    <p class="text-muted">No featured products available.</p>
                </div>
            }
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="features-section bg-light py-5">
    <div class="container">
        <div class="row g-4 text-center">
            <div class="col-md-4">
                <div class="feature-item">
                    <i class="fas fa-shipping-fast fa-3x text-primary mb-3"></i>
                    <h5>Free Shipping</h5>
                    <p class="text-muted">Free shipping on orders over $50</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-item">
                    <i class="fas fa-shield-alt fa-3x text-primary mb-3"></i>
                    <h5>Secure Payment</h5>
                    <p class="text-muted">100% secure payment processing</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-item">
                    <i class="fas fa-undo fa-3x text-primary mb-3"></i>
                    <h5>Easy Returns</h5>
                    <p class="text-muted">30-day return policy</p>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
    /* Fixed Image Container */
    .product-image-container {
        position: relative;
        width: 100%;
        height: 250px; /* Fixed height */
        overflow: hidden;
        background: #f8f9fa;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .product-list-image {
        width: 100%;
        height: 100%;
        object-fit: cover; /* Fill container without distortion */
        object-position: center;
        transition: transform 0.3s ease;
    }

    .product-card:hover .product-list-image {
        transform: scale(1.05);
    }

    /* Card Structure */
    .product-card {
        display: flex;
        flex-direction: column;
        height: 100%;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15) !important;
        }

        .product-card .card-body {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 1.25rem;
        }

        .product-card .card-footer {
            flex-shrink: 0;
            padding: 1rem 1.25rem;
        }

    /* Text Styling */
    .product-name {
        font-size: 1rem;
        font-weight: 600;
        line-height: 1.3;
        margin-bottom: 0.5rem;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        min-height: 2.6rem;
    }

    .product-brand {
        font-size: 0.85rem;
        margin-bottom: 1rem;
        color: #6c757d !important;
    }

    /* Badges and Overlays */
    .featured-badge {
        position: absolute;
        top: 10px;
        left: 10px;
        background: #ffc107;
        color: #000;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.75rem;
        font-weight: 600;
        z-index: 2;
    }

    .out-of-stock-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.7);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        z-index: 1;
    }

    /* Buttons */
    .btn-sm {
        padding: 0.5rem 1rem;
        font-size: 0.875rem;
    }

    /* Categories */
    .category-card {
        transition: transform 0.3s ease;
    }

        .category-card:hover {
            transform: translateY(-5px);
        }

    .category-icon {
        transition: transform 0.3s ease;
    }

    .category-card:hover .category-icon {
        transform: scale(1.1);
    }

    /* Features */
    .feature-item {
        padding: 2rem 1rem;
        transition: transform 0.3s ease;
    }

        .feature-item:hover {
            transform: translateY(-5px);
        }

        .feature-item i {
            transition: transform 0.3s ease;
        }

        .feature-item:hover i {
            transform: scale(1.1);
        }


</style>